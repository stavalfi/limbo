# #!/bin/bash

set -e

# .envrc have predefined bash helper functions - https://direnv.net/man/direnv-stdlib.1.html

PATH_add "$PWD/packages/devex/shell/zsh/clis"

rm -rf "$PWD/.devbox/devex/shell/zsh/aliases"

export_alias() {
  # Create a new alias
  local name=$1
  shift

  local alias_dir="$PWD/.devbox/devex/shell/zsh/aliases"
  local alias_file="$alias_dir/$name"
  local oldpath="$PATH"

  # If this is the first time we're calling export_alias, add to PATH once
  if ! [[ ":$PATH:" == *":$alias_dir:"* ]]; then
    mkdir -p "$alias_dir"
    PATH_add "$alias_dir"
  fi

  # Write the alias file
  cat <<EOT >$alias_file
#!/usr/bin/env bash -e
PATH="$oldpath"
exec $@
EOT
  chmod +x "$alias_file"
}

export_alias 'config.zsh' 'cursor ~/.zshrc'

eval "$(devbox generate direnv)"
